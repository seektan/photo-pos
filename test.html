<div id="container" style="width:500px; height:300px"></div>

<div id="drop_zone" ondrop="dropHandler(event);" ondragover="dragOverHandler(event);" style="width:200px; height:50px">
  <p>Drag one or more files to this Drop Zone ...</p>
</div>
<style>
#preview img{width: 200px;margin: 10px;}
</style>
<div id="preview"></div>

<script src="https://cdn.jsdelivr.net/npm/exifr/dist/lite.umd.js"></script>
<script>
var preview = document.getElementById('preview');
function dropHandler(ev) {
  console.log('File(s) dropped');

  // Prevent default behavior (Prevent file from being opened)
  ev.preventDefault();

  for (const file of ev.dataTransfer.files) {
    const reader = new FileReader();
    reader.addEventListener('load', (event) => {
      var img = document.createElement('img');
      img.src = event.target.result;
      img.crossOrigin = "anonymous";
      preview.appendChild(img);
      console.log('files data: ', img);
      window.exifr.parse(img).then(function(exif){
        console.log('files exif: ', exif);
      });
    });
    reader.readAsDataURL(file);
  };
}
function dragOverHandler(ev) {
  console.log('File(s) in drop zone'); 

  // Prevent default behavior (Prevent file from being opened)
  ev.preventDefault();
}



var defaultPos = null;
function init() {
    if (!defaultPos) return;
  var myLatlng = new qq.maps.LatLng(defaultPos[0], defaultPos[1]);
  var myOptions = {
    zoom: 8,
    center: myLatlng,
    mapTypeId: qq.maps.MapTypeId.ROADMAP
  }
  var map = new qq.maps.Map(document.getElementById("container"), myOptions);
  
}
 
function loadScript() {
  var script = document.createElement("script");
  script.type = "text/javascript";
  script.src = "https://map.qq.com/api/js?v=2.exp&key=D3SBZ-M37KQ-IU55Z-GZ45Q-6GBCV-OYB34&callback=init";
  document.body.appendChild(script);
}
 
window.onload = function () {
    // getExif('img');
    // getExif('img1');
    // getExif('img2');
}

function getExif(photoId) {
    var img = document.getElementById(photoId);
    window.exifr.parse(img).then(function(exif){
        console.log(exif);
        var ret = ['original time: ' + new Date(exif.DateTimeOriginal), 'latitude: ' + exif.latitude, 'longitude: ' + exif.longitude];
        document.getElementById(photoId + "_exif").innerHTML = ret.join('<br>');
        if (photoId === 'img') {
            defaultPos = [exif.latitude, exif.longitude];
            loadScript();
        }
    });
}
</script>
